#include <stdio.h>
#include <string.h>
#include <malloc.h>
#include "base64.h"


int main()
{
    uint8_t hex[112] ={
        0xBA, 0x65, 0x08, 0x15, 0x0F, 0x42, 0xCE, 0x89, 0x4C, 0x24, 0x7C, 0x0F, 0xBA, 0xE0, 0x0C, 0x73,
        0x09, 0xC6, 0x87, 0x23, 0x02, 0x00, 0x00, 0x01, 0xEB, 0x0F, 0x41, 0x0F, 0xBA, 0x65, 0x08, 0x0C,
        0x73, 0x07, 0x40, 0x88, 0xB7, 0x23, 0x02, 0x00, 0x00, 0x41, 0x0F, 0xBA, 0x65, 0x04, 0x0D, 0x73,
        0x09, 0xC6, 0x87, 0x20, 0x02, 0x00, 0x00, 0x01, 0xEB, 0x0F, 0x41, 0x0F, 0xBA, 0x65, 0x08, 0x0D,
        0x73, 0x07, 0x40, 0x88, 0xB7, 0x20, 0x02, 0x00, 0x00, 0x41, 0x0F, 0xBA, 0x65, 0x04, 0x0E, 0x73,
        0x09, 0xC6, 0x87, 0x21, 0x02, 0x00, 0x00, 0x01, 0xEB, 0x0F, 0x41, 0x0F, 0xBA, 0x65, 0x08, 0x0E,
        0x73, 0x07, 0x40, 0x88, 0xB7, 0x21, 0x02, 0x00, 0x00, 0x41, 0x0F, 0xBA, 0x65, 0x04, 0x0F, 0x73
    };

    uint8_t encode_out[BASE64_ENCODE_OUT_SIZE(112)] = { 0 };
    uint32_t encode_len = base64_encode(hex, 112, encode_out);

    printf("encode length: %u\n", encode_len);
    printf("encode data: %s\n", encode_out);

    printf("======================================================================================================\n");

    uint8_t *decode_out = (uint8_t *)calloc(1, BASE64_DECODE_OUT_SIZE(encode_len));
    uint32_t decode_len = base64_decode(encode_out, encode_len, decode_out);

    printf("decode length: %u\n", decode_len);

    if(memcmp(hex, decode_out, decode_len) == 0)
    {
        printf("decode success\n");
    }
    else
    {
        printf("decode fail\n");
    }

    return 0;
}

